# PaperAxon 详细设计文档（V0.1）

本文档为 **V0.1 版本详细设计**，基于 [《需求说明文档 v0.1》](./需求说明文档v0.1.md) 给出系统设计。**当前设计针对版本：V0.1。**

约定多智能体采用 **LangGraph**、其余模块以**轻量化与开源**为原则，模型服务统一使用 **Qwen（通义千问）API**。**总体原则：快速实现、轻量化、开源模块。**

---

## 1. 概述与设计原则

### 1.1 设计目标
- **多智能体**：使用 LangGraph 实现规划与调度 + 功能智能体（解析、解读、检索、记忆、播客），职责清晰、可扩展。
- **轻量化与开源**：除模型 API 外，后端与前端尽量采用轻量、开源组件，便于部署与二次开发。
- **模型统一**：文本类大模型调用统一走 Qwen API（解读、播客稿、规划等）；TTS 使用阿里云语音合成，与 Qwen 分开配置。

### 1.2 技术原则
- 后端：Python 为主；LangGraph + LangChain 兼容层对接 Qwen。
- 存储：SQLite + 本地文件，**所有数据与文件统一放在项目下 `data/` 目录**；向量检索等可选能力 V0.1 不实现，但**预留接口**便于后续扩展。
- 前端：**Vue 3 + 轻量 UI 库**（易于维护与视觉效果平衡）；单页应用，通过网页访问。
- 定时任务：应用内调度器或系统 cron，由前端可配置的「是否开启 + 采集时间」驱动。

### 1.3 V0.1 实现约定（已确认）

| 项 | 约定 | 说明 |
|----|------|------|
| 前端框架 | **Vue 3** | 易于维护与视觉效果，轻量 UI 组件库 |
| 大模型 | **Qwen Plus** | 模型名 `qwen-plus` |
| API Key | **分服务配置** | Qwen 用 `DASHSCOPE_API_KEY`，TTS 用阿里云独立 Key（如 `ALIYUN_TTS_*`），不共用 |
| TTS | **阿里云语音合成** | 需配置阿里云 TTS 相关 Key/AppKey |
| 每日采集默认规则 | **近 24 小时** | 每次采集拉取 arXiv 近 24 小时内更新的论文；主题/分类默认采用 **cat=physics.hist-ph**（物理史），便于实现，后续可改为可配置或优化 |
| 采集范围 | 每次运行仅拉近 24h | 按 arXiv 更新时间筛选 |
| 上传文件大小 | **暂不限制** | 后续可按需加限制 |
| 解读 / 播客 | **异步** | 触发后返回任务 ID，前端轮询任务状态或结果；避免长连接阻塞 |
| 登录与鉴权 | **不做** | 单用户、本机或内网使用，不实现登录与鉴权 |
| 数据与文件 | **统一在 `data/` 下** | 见 5.2 |
| 服务端口 | **18527** | 后端 API 默认监听 18527（五位数防冲突） |
| 可选能力 | **先不做，预留接口** | 向量检索、复杂相关论文等预留 API 或服务接口，便于后续实现 |
| **MCP 与 Skill** | **预留，不实现** | 架构与接口设计预留 MCP（对外提供/消费能力）与 Skill（可插拔能力模块）扩展点，V0.1 不实现具体逻辑，见第 9 章 |
| **paper_id** | **nanoid** | 论文唯一标识，短、URL 友好，用于 DB 与文件路径 |
| **异步任务** | **SQLite tasks 表** | 任务状态与结果持久化，重启后可查；轮询间隔 **2 秒**，超时 **15 分钟** |
| **采集时间** | **"HH:mm"**，**服务器本地时区** | 如 "00:00"；定时任务按服务器本地时区执行 |
| **arXiv 拉取** | **元数据 + PDF 一并落盘** | 拉取时即下载 PDF 到 `data/papers/`；同 arXiv ID 已存在则**更新该条并返回已有 paper_id**，不重复创建 |
| **相关论文 V0.1** | **arXiv API 搜索** | 用当前论文 title + abstract 调 arXiv 查询接口返回相关论文，不接向量库 |
| **前端 UI 库** | **Element Plus** | Vue 3 生态常用、轻量，与快速实现原则一致 |
| **前后端同源** | **生产同源、开发代理** | 生产：前端静态资源由后端 18527 托管；开发：前端 dev 代理到 18527，无需 CORS |
| **解析/生成失败** | **不重试** | 任务置为 failed，返回 error 信息；规划节点不重试，直接结束 |
| **播客版本** | **V0.1 仅单版本** | 每篇论文对应一份播客（约 15 分钟版），多版本留作后续扩展 |
| **阿里云 TTS** | **以官方文档为准** | 环境变量见 7.2；产品名与必填 Key 以阿里云智能语音合成文档为准 |

---

## 2. 系统架构

### 2.1 总体架构

```
                    +------------------+
                    |   前端 Web 页面   |
                    | (论文管理/解读/   |
                    |  播客/设置/图谱)  |
                    +--------+---------+
                             | HTTP/API
                             v
+------------------------------------------------------------------+
|                        后端服务 (Python)                           |
|  +----------------+  +----------------+  +----------------------+ |
|  |  API 层        |  |  定时采集      |  |  知识图谱 / 热度     | |
|  | (FastAPI/Flask)|  |  (调度器)      |  |  (计算与接口)        | |
|  +-------+-+------+  +----------------+  +----------------------+ |
|          | |                                                      |
|          v v                                                      |
|  +----------------------------------------------------------------+|
|  |           多智能体层 (LangGraph)                                ||
|  |  +------------+   +----------+   +----------+   +------------+  ||
|  |  | 规划智能体  |-->| 解析     |-->| 解读     |-->| 记忆/播客  |  ||
|  |  | (调度节点)  |   | 智能体   |   | 智能体   |   | 智能体    |  ||
|  |  +------------+   +----------+   +----------+   +------------+  ||
|  |         |                \         |              /          ||
|  |         +-----------------> 检索智能体 <-------------------+  ||
|  +----------------------------------------------------------------+|
|                             |                                      |
|  +--------------------------+--------------------------------------+|
|  |  存储与外部服务：SQLite、文件、向量库、Qwen API、TTS、arXiv   ||
|  +------------------------------------------------------------------+|
+------------------------------------------------------------------+
```

### 2.2 分层说明
| 层级 | 职责 | 选型建议 |
|------|------|----------|
| 前端 | 论文列表/详情、解读展示、播客播放、设置（自动采集开关与时间）、知识图谱与热度 | 轻量 SPA，开源 UI |
| API 层 | 路由、请求校验、调用 LangGraph 与采集/图谱服务（V0.1 无鉴权） | FastAPI |
| 多智能体层 | 规划与调度、解析/解读/检索/记忆/播客 | **LangGraph** |
| 存储与外部 | 持久化、大模型、TTS、arXiv（向量检索 V0.1 预留接口） | SQLite、文件、Qwen API、阿里 TTS、arXiv |

---

## 3. 多智能体架构（LangGraph）

### 3.1 选型说明
- **LangGraph**：用有向图定义多智能体流程，支持条件边、状态共享，与「规划智能体 + 功能智能体」的 Supervisor 模式匹配。
- **状态**：共享状态（如论文 ID、解析结果、解读文本、当前请求类型）在图中流转，各节点读/写状态。

### 3.2 图结构设计

- **节点**：
  - **planner**（规划智能体）：根据 `request_type` 与已有状态决定下一节点。
  - **parser**（解析智能体）：PDF/arXiv 解析，输出结构化元数据与正文片段。
  - **interpreter**（解读智能体）：调用 Qwen 生成中文解读报告。
  - **retriever**（检索智能体）：查相关论文（arXiv API 或本地向量）。
  - **memory**（记忆智能体）：写入/更新论文记忆库。
  - **podcast**（播客智能体）：解读转播客稿 + 调用 TTS 生成音频。

- **边**：
  - 入口 → **planner**。
  - **planner** → parser / interpreter / retriever / memory / podcast / END（条件边，由 planner 输出 `next_node` 决定）。
  - parser → interpreter；interpreter → memory；memory → podcast（流水线边）。
  - 按需分支：例如 `request_type == "related_only"` 时 planner → retriever → END；已有解读且 `request_type == "podcast_only"` 时 planner → podcast → END。

### 3.3 状态结构（State）

建议在 LangGraph 中定义统一状态（如 TypedDict），在各节点间传递：

| 字段 | 类型 | 说明 |
|------|------|------|
| request_type | str | 请求类型：interpret / related_only / podcast_only / full_pipeline 等 |
| paper_input | dict | 输入：本地 PDF 路径或 arXiv ID/URL |
| paper_id | str | 系统内论文 ID（若已存在） |
| parse_result | dict | 解析结果：标题、作者、摘要、章节等 |
| interpretation | str | 解读报告（Markdown） |
| related_papers | list | 相关论文列表 |
| memory_updated | bool | 是否已写记忆 |
| podcast_audio_path | str | 生成的播客音频路径 |
| error | str | 错误信息（若有） |
| next_node | str | 规划节点输出的下一节点名 |

### 3.4 规划智能体（Planner）逻辑

- **输入**：当前 state（含 `request_type`、是否已有 `interpretation`/`paper_id` 等）。
- **实现方式**：
  - **方案 A（推荐）**：规则路由。根据 `request_type` 与 state 直接返回 `next_node`（如 "parser" / "interpreter" / "retriever" / "podcast" / "memory" / END），无需调用 LLM，稳定、省成本。
  - **方案 B**：调用 Qwen 做一次「规划」生成 `next_node`，适合将来请求类型很多、需要自然语言理解时再引入。
- **输出**：更新 state 的 `next_node`，图中条件边根据 `next_node` 跳转。

### 3.5 各功能智能体与 Qwen 的配合

- **解读智能体**：将解析结果（摘要、章节摘要等）通过 **Qwen API** 生成结构化中文解读（背景、方法、结果、创新点等），输出 Markdown。
- **播客智能体**：将解读内容通过 **Qwen API** 改写成口语化播客稿，再调用 TTS 生成中文音频；TTS 可选用支持中文的开源或云服务（与 Qwen 独立）。
- **检索智能体**：主要依赖 arXiv API 或本地向量库，可选使用 Qwen 对查询做关键词/意图扩展。
- **记忆智能体**：以写库与检索为主，可选 Qwen 做摘要压缩后再存。

所有调用 Qwen 的模块统一走 **3.6 节** 的 Qwen 客户端配置。

### 3.6 与需求文档的对应

- 需求中的「规划智能体」对应本图中的 **planner** 节点。
- 「解析 / 解读 / 检索 / 记忆 / 播客」对应 **parser / interpreter / retriever / memory / podcast** 节点。
- 流水线式与按需触发通过 planner 的条件边与不同 `request_type` 实现。

---

## 4. 各模块详细设计

### 4.1 论文输入与解析

- **输入来源**：仅两种——本地上传 PDF、arXiv（链接/ID/摘要页 URL）。
- **本地上传 PDF**：
  - 前端上传文件至后端，后端落盘到指定目录（如 `data/papers/`），生成唯一 `paper_id`，并将路径写入 state 或 DB。
  - 解析使用开源库：**PyMuPDF (fitz)** 或 **pdfplumber** 提取文本与基础结构；需要时用 **pdf2image** 做图表区域检测（可选）。
- **arXiv**：
  - 从 URL/ID 解析出 arXiv ID（如 `2301.12345`），使用 **arXiv API** 拉取元数据；**拉取时即下载 PDF** 到 `data/papers/`，与本地 PDF 走同一解析管道。若 DB 中已有该 `arxiv_id`，则**更新该条记录并返回已有 paper_id**，不重复创建。
- **解析输出结构**：统一为 JSON/Mapping，包含：title, authors, abstract, keywords, sections（列表），references（可选），raw_text（可选）。便于解读智能体消费。

### 4.2 论文记忆与存储

- **存储**：
  - **SQLite**：论文元信息（paper_id, title, authors, year, source_type, source_url, created_at, updated_at）、解读摘要或全文引用、播客是否已生成、标签等。
  - **本地文件**：解读全文 Markdown 存 `data/interpretations/{paper_id}.md`；播客音频存 `data/podcasts/{paper_id}.mp3`；原始 PDF 存 `data/papers/`。
- **检索**（V0.1 满足「至少两种」）：
  - **关键词/标题/作者**：SQLite LIKE 或 FTS5；
  - **时间/标签筛选**：按 created_at、标签等筛选。
  - 语义检索：V0.1 不实现，**预留接口**便于后续接向量库（Chroma/FAISS 等）。
- **记忆智能体**：负责在「解读完成后」将论文元信息 + 解读索引写入 SQLite。

### 4.3 播客生成与 TTS

- **播客稿**：由播客智能体调用 **Qwen API**，将解读 Markdown 转为口语化、分段的播客脚本（开场白、小节过渡、结束语）；**V0.1 每篇论文仅生成一份播客**（约 15 分钟版）。
- **TTS**：采用**阿里云语音合成**，使用独立于 Qwen 的 API Key 配置；输出 MP3，保存到 `data/podcasts/{paper_id}.mp3`，并在 DB 中标记已生成。

### 4.4 每日定时采集（arXiv）

- **配置**：来自前端设置——「是否每日自动采集」、「采集时间」（默认凌晨 0 点）。在 DB 的 `settings` 表中持久化（如 `auto_collect_enabled`、`collect_time`）。
- **调度**：应用内使用 **APScheduler** 等在配置时间执行采集任务（服务常驻时）；或由系统 cron 调用后端「采集」接口，时间与前端配置一致。
- **采集逻辑**：
  - **范围**：每次采集**近 24 小时**内更新的论文。
  - **默认筛选**：V0.1 固定使用 arXiv 分类 **cat=physics.hist-ph**（物理史），实现简单；后续版本可改为可配置 cat/query。
  - 去重：按 arXiv ID 与 DB 比对，新论文仅写入元数据到「待处理」或「已收录」表，不自动解读（用户可手动触发解读与播客）。

### 4.5 知识图谱与热度（V0.1 轻量实现）

- **知识图谱**：
  - 节点：论文（paper_id）、主题/关键词、作者。
  - 边：论文-主题、论文-作者、论文-论文（基于引用或同分类等轻量关系）。
  - **实现**：**NetworkX** 在内存建图，导出节点与边；前端 **Cytoscape.js** 或 **D3.js** 交互展示。无额外图数据库。
- **热度**：
  - 指标：播放次数、解读次数、最近访问时间（DB 统计）。
  - 展示：列表排序、图谱节点大小或颜色。

### 4.6 前端

- **技术选型**：**Vue 3** + **Element Plus**，单页应用，通过浏览器访问。
- **页面**：
  - 论文列表（支持简单管理：录入、删除、筛选）；论文详情（解读文字版 + 播放播客按钮）。
  - 设置页：**是否每日自动采集**（开关）、**采集时间**（时间选择器，默认 0:00）。
  - 可选：知识图谱与热度页、相关论文列表。
- **与后端交互**：REST API，**解读/播客为异步**——触发后返回任务 ID，前端轮询任务状态或结果接口直至完成。
- **播放器**：HTML5 Audio 或轻量播放器组件，支持播放/暂停、进度条、倍速。

---

## 5. 数据模型与存储

### 5.1 核心表（SQLite）

- **papers**  
  - id (PK), paper_id (UK), source_type (local_pdf | arxiv), source_path_or_url, title, authors, abstract, arxiv_id, published_at, created_at, updated_at

- **interpretations**  
  - id (PK), paper_id (FK), content_path (解读 Markdown 文件路径，如 `data/interpretations/{paper_id}.md`), created_at

- **tasks**  
  - id (PK), task_id (UK), type (interpret | podcast | ...), status, result (JSON 或 null), error (TEXT 或 null), created_at, updated_at

- **podcasts**  
  - id (PK), paper_id (FK), audio_path, duration_sec, created_at

- **settings**  
  - key (PK), value (JSON 或文本)  
  - 示例：auto_collect_enabled=true, collect_time=00:00

- **related_papers**（可选）  
  - 缓存「相关论文」结果，避免重复调用 API

- **collect_logs**（可选）  
  - 记录每次定时采集的时间与新增条数，便于排查

### 5.2 文件与数据目录（约定统一在 data/）

**所有持久化数据与文件均放在项目根下 `data/` 目录**，便于备份与迁移。

```
data/
  papers/          # 上传/下载的 PDF
  interpretations/ # 解读 Markdown 文件
  podcasts/        # 生成的音频
  paper_axon.db    # SQLite 文件（或 data/db/ 下）
```

- 路径可通过环境变量（如 `DATA_DIR`）覆盖，默认即项目下的 `data/`。

---

## 6. 接口设计（API）

### 6.1 与前端的主要接口

| 方法 | 路径 | 说明 |
|------|------|------|
| POST | /api/papers/upload | 上传本地 PDF，返回 paper_id（V0.1 不限制文件大小） |
| POST | /api/papers/from-arxiv | body: { url \| arxiv_id }，拉取并创建论文，返回 paper_id |
| POST | /api/papers/{paper_id}/interpret | **异步**：触发解读，返回 **task_id** |
| GET  | /api/tasks/{task_id} | 查询任务状态与结果（解读/播客等异步任务通用），返回格式见 6.3 |
| GET  | /api/papers/{paper_id} | 获取论文元信息 |
| GET  | /api/papers/{paper_id}/interpretation | 获取解读正文 |
| GET  | /api/papers/{paper_id}/podcast | 获取播客音频 URL 或文件流 |
| POST | /api/papers/{paper_id}/podcast | **异步**：若未生成则生成播客，返回 **task_id**；完成后通过 GET /api/tasks/{task_id} 或 GET /api/papers/{paper_id}/podcast 获取音频 |
| GET  | /api/papers | 论文列表（分页、筛选） |
| DELETE | /api/papers/{paper_id} | 删除论文（及解读、播客记录） |
| GET  | /api/papers/{paper_id}/related | 相关论文列表（V0.1 可基于 arXiv/本地简单检索；**语义检索预留接口**） |
| GET  | /api/settings/collect | 获取采集设置（是否开启、采集时间） |
| PUT  | /api/settings/collect | 更新采集设置 |
| GET  | /api/knowledge-graph | 知识图谱节点与边（V0.1 轻量实现） |
| GET  | /api/trending | 热度列表（V0.1） |

- **扩展预留**：语义检索、向量检索等可在 `/api/papers/search` 或现有 related 接口内预留参数/实现层，便于后续接入向量库而不改 URL。

### 6.3 异步任务返回格式（GET /api/tasks/{task_id}）

统一结构（JSON）：

```json
{
  "task_id": "string",
  "status": "pending" | "running" | "success" | "failed",
  "result": null | { "paper_id": "...", "interpretation_path": "..." } | { "paper_id": "...", "podcast_url": "..." },
  "error": null | "string"
}
```

- `pending` / `running`：进行中，前端继续轮询（建议间隔 2 秒，超时 15 分钟）。
- `success`：`result` 含业务数据（解读任务返回 interpretation 相关，播客任务返回 podcast 相关）。
- `failed`：`error` 为简要原因，前端展示提示。

### 6.2 智能体间契约（内部）

- 解析智能体：输入 `paper_input`（路径或 arXiv ID），输出 `parse_result`（结构化 dict）。
- 解读智能体：输入 `parse_result`，输出 `interpretation`（Markdown 字符串）。
- 记忆智能体：输入 `paper_id` + `interpretation` + 元信息，写 SQLite 与可选向量库，输出 `memory_updated`。
- 播客智能体：输入 `interpretation`，输出播客稿 + `podcast_audio_path`。
- 检索智能体：输入 `paper_id` 或 query，输出 `related_papers`（list）。

错误通过 state 的 `error` 字段或异常在图中传递；**V0.1 不重试**，规划节点在出错时直接结束并写回 error。

---

## 7. 模型与语音服务

### 7.1 Qwen API（大模型）

- **接入**：阿里云百炼 / DashScope 的 **OpenAI 兼容接口**，与 LangChain/LangGraph 集成（如 `ChatOpenAI` 指定 `base_url` 与 `api_key`）。
- **配置**（与 TTS 分开，独立 Key）：
  - 环境变量 **`DASHSCOPE_API_KEY`**：仅用于 Qwen 调用，不在代码中硬编码。
  - 官方文档：[阿里云百炼 - 千问 API](https://help.aliyun.com/zh/model-studio/qwen-api-reference)、[首次调用](https://help.aliyun.com/zh/model-studio/first-api-call-to-qwen)。
- **模型**：**qwen-plus**（`model="qwen-plus"`），用于解读、播客稿、可选规划等。

### 7.2 阿里云 TTS（语音合成）

- **用途**：将播客稿转为中文语音，输出 **MP3** 存于 `data/podcasts/`。
- **配置**：使用**独立于 Qwen** 的阿里云语音合成服务；环境变量以**阿里云智能语音合成**当前文档为准，常见包括（具体名称以官方文档为准）：
  - `ALIYUN_TTS_APP_KEY` 或对应 AppKey
  - `ALIYUN_TTS_ACCESS_KEY_ID` / `ALIYUN_TTS_ACCESS_KEY_SECRET`（若该产品使用 AccessKey）
- **说明**：与 `DASHSCOPE_API_KEY` 分开配置，便于权限与计费隔离。实现时按阿里云控制台与 API 文档配置即可。

### 7.3 注意点

- 模型与 TTS 限频、计费以各自控制台说明为准。
- 敏感数据：按需求文档，可仅使用境内服务与加密传输。

---

## 8. 技术选型汇总（轻量 + 开源）

| 类别 | 选型 | 说明 |
|------|------|------|
| 多智能体 | LangGraph + LangChain | 图编排与 Qwen 对接 |
| 后端框架 | FastAPI | 轻量、异步、自动 OpenAPI |
| 数据库 | SQLite | 单文件、零配置 |
| PDF 解析 | PyMuPDF / pdfplumber | 开源 |
| arXiv | arxiv Python 包或 requests | 官方 API |
| 向量检索（可选） | 预留接口，V0.1 不实现 | 后续可接 Chroma/FAISS 等 |
| TTS | **阿里云语音合成** | 独立 Key，与 Qwen 分开配置 |
| 定时任务 | APScheduler 或 cron | 应用内或系统级 |
| 知识图谱 | NetworkX + Cytoscape.js/D3 | 内存建图 + 前端可视化，轻量无额外服务 |
| 前端 | **Vue 3** + 轻量 UI（如 Element Plus） | 单页应用，易于维护与视觉效果 |

---

## 9. 未来扩展：MCP 与 Skill（V0.1 预留）

**V0.1 约定**：本章描述的能力**仅作预留**，当前版本不实现。实现时需保证：架构上预留扩展点（如 MCP 适配层入口、Skill 注册/发现接口）、现有 API 与 LangGraph 节点便于被 MCP/Skill 复用，不因后续接入而破坏现有接口。

系统在架构上预留 **MCP（Model Context Protocol）** 与 **Skill** 的扩展能力，便于后续与生态集成与能力插件化。

### 9.1 MCP（Model Context Protocol）

- **目标**：让 PaperAxon 既能**对外提供**论文相关能力，也能**消费**外部数据与工具。
- **作为 MCP Server**：将「解析论文」「获取解读」「检索相关论文」「生成播客」等封装为 MCP **Tools** 或 **Resources**，供支持 MCP 的客户端（如 Cursor、其他 AI 应用）调用，实现「在任意环境中查询/解读论文」。
- **作为 MCP Client**：接入外部 MCP 服务（如文献库、笔记应用），由规划智能体或检索智能体在适当时机调用，扩展数据源与能力边界。
- **实现要点**：后端增加 MCP 适配层（可选用官方或社区 MCP SDK），将现有 API 或 LangGraph 能力映射为 MCP 的 tools/resources；认证与传输按 MCP 规范配置。

### 9.2 Skill

- **目标**：将可复用的能力模块化为 **Skill**（如「论文对比」「导出笔记」「自定义解读模板」），由系统**加载与调度**，便于用户或开发者扩展而不改核心代码。
- **形态**：每个 Skill 具备清晰输入/输出与描述，可由规划智能体根据用户意图选择调用（例如用户说「对比这两篇论文」时调度「论文对比」Skill）；Skill 可配置为内置或从本地/远程目录加载（如 Cursor Skill 的约定格式）。
- **与多智能体的关系**：Skill 可作为 LangGraph 中的**子图或可插拔节点**：规划节点在状态中识别到需要某 Skill 时，路由到对应节点执行，结果写回状态并继续流转。
- **实现要点**：定义 Skill 注册与发现机制（如配置文件或约定目录下的 SKILL.md + 入口）；规划智能体或路由层维护「意图 → Skill」映射；后续可考虑与 MCP Tools 对齐，使部分 Skill 同时暴露为 MCP 工具。

### 9.3 与当前设计的关系（预留要点）

- 现有 **API 层** 与 **LangGraph 状态/节点** 保持稳定；MCP 与 Skill 作为**附加层**接入，不替代现有接口。
- 数据模型与存储（SQLite、文件）无需为 MCP/Skill 做结构性变更，仅通过新端点或新节点读写既有数据。
- **预留方式**：V0.1 实现时可为 MCP 适配层、Skill 注册/发现预留目录或占位接口（如 `mcp/`、`skills/` 或配置项），不在本版实现具体逻辑。

---

## 10. 部署与运行

- **环境**：Python 3.10+；依赖用 `requirements.txt` 管理（langgraph, langchain, fastapi, pymupdf 等）。
- **配置**（环境变量或 `.env`）：
  - **DASHSCOPE_API_KEY**：Qwen API Key；
  - **阿里 TTS**：阿里云语音合成相关 Key（如 ALIYUN_TTS_APP_KEY 等，以阿里云文档为准）；
  - **DATA_DIR**（可选）：数据根目录，默认项目下 `data/`；
  - **PORT**（可选）：服务端口，**默认 18527**（五位数防冲突）。
- **启动**：后端监听 **18527**，提供 API；前端 build 后可由同一 FastAPI 托管静态资源（推荐）或独立部署。
- **定时采集**：APScheduler 随后端进程启动，按前端配置的时间与开关执行；或由系统 cron 调用后端采集接口。
- **无鉴权**：V0.1 不提供登录与鉴权，建议仅本机或内网访问。

---

## 11. 文档修订记录

| 版本 | 日期 | 修订内容 |
|------|------|----------|
| 0.1 | 2025-02-11 | 初稿：LangGraph 多智能体、Qwen API、轻量化与开源选型、各模块与接口设计 |
| 0.2 | 2025-02-11 | 知识图谱仅保留轻量方案（NetworkX）；新增「未来扩展：MCP 与 Skill」章节 |
| 0.3 | 2025-02-11 | V0.1 实现约定：Vue3、qwen-plus、API Key 分服务、TTS 阿里、采集近24h+默认 cat、异步解读/播客、无鉴权、data/、端口 18527、可选能力预留接口 |
| 0.4 | 2025-02-12 | 去除不确定点：paper_id 用 nanoid、任务表与轮询/超时、采集时区、arXiv 落盘与去重、相关论文用 arXiv API、Element Plus、失败不重试、播客单版本、任务返回格式 6.3；知识图谱与热度明确为 V0.1 轻量实现；记忆检索两种方式明确；补充 tasks 表与阿里云 TTS 配置说明 |
| 0.5 | 2025-02-15 | MCP 与 Skill 明确为 V0.1 预留能力：实现约定表增加「MCP 与 Skill：预留、不实现」；第 9 章补充 V0.1 预留约定与预留方式（目录/占位接口） |
